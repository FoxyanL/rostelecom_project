# Децентрализованная система голосования на базе Ethereum

## Описание проекта

Децентрализованное приложение (DApp) для проведения прозрачных и безопасных голосований с использованием смарт-контрактов в сети Ethereum.

### Основные возможности

- Прозрачное голосование с записью всех данных в блокчейн
- Безопасность — невозможность изменения результатов после голосования
- Защита от повторного голосования (один адрес = один голос)
- Отображение результатов в реальном времени
- Полностью децентрализованная архитектура

## Назначение системы

Система предназначена для проведения голосований в:
- Учебных и демонстрационных проектах
- Студенческих опросах
- Децентрализованных сообществах
- Примерах использования Web3-технологий

## Архитектура

Проект построен на основе Scaffold-ETH 2 и включает:

### Технологический стек

- **Solidity** — разработка смарт-контрактов
- **Hardhat** — среда разработки и тестирования
- **Next.js** — фронтенд-фреймворк
- **TypeScript** — типизация
- **Wagmi / Viem** — взаимодействие с блокчейном
- **RainbowKit** — подключение кошельков
- **Tailwind CSS** — стилизация интерфейса

### Структура проекта

```
packages/
  hardhat/          # Смарт-контракты и тесты
    contracts/
      Voting.sol    # Основной контракт голосования
    test/
      Voting.test.ts # Модульные тесты
    deploy/         # Скрипты развёртывания
  
  nextjs/           # Фронтенд-приложение
    app/
      page.tsx      # Главная страница с интерфейсом голосования
```


## Требования

Перед началом работы установите:

- [Node.js](https://nodejs.org/) >= v18.17
- [Yarn](https://classic.yarnpkg.com/en/docs/install/) (v1 или v2+)
- [Git](https://git-scm.com/downloads)

## Быстрый старт

### 1. Клонирование репозитория

```bash
git clone <repository-url>
cd rostelecom_project
```

### 2. Установка зависимостей

```bash
yarn install
```

### 3. Запуск локальной блокчейн-сети

Откройте первый терминал и выполните:

```bash
yarn chain
```

Эта команда запустит локальную Ethereum-сеть с помощью Hardhat.

### 4. Развёртывание смарт-контракта

Откройте второй терминал и выполните:

```bash
yarn deploy
```

Смарт-контракт будет развёрнут в локальной сети с тремя вариантами голосования по умолчанию.

### 5. Запуск фронтенд-приложения

Откройте третий терминал и выполните:

```bash
yarn start
```

Откройте браузер и перейдите по адресу: **http://localhost:3000**

### 6. Подключение MetaMask

1. Установите расширение [MetaMask](https://metamask.io/)
2. Подключитесь к локальной сети (Hardhat обычно на порту 8545)
3. Импортируйте тестовый аккаунт из Hardhat (приватный ключ будет показан при запуске `yarn chain`)

## Функциональность смарт-контракта

### Основные функции

**`vote(uint256 optionIndex)`**
- Позволяет пользователю проголосовать за выбранный вариант
- Проверяет, что пользователь ещё не голосовал
- Эмитирует событие `Voted`

**`getOptionsCount()`**
- Возвращает количество вариантов голосования

**`getOption(uint256 index)`**
- Возвращает название и количество голосов для конкретного варианта

**`getAllOptions()`**
- Возвращает все варианты с результатами голосования

**`checkIfVoted(address voter)`**
- Проверяет, голосовал ли указанный адрес

### События

**`Voted(address indexed voter, uint256 indexed optionIndex, string optionName)`**
- Эмитируется при успешном голосовании

**`VotingCreated(uint256 optionsCount)`**
- Эмитируется при создании нового голосования

## Тестирование

### Запуск тестов

```bash
yarn hardhat:test
```

### Покрытие тестами

Тесты включают проверку:
- ✅ Корректного развёртывания контракта
- ✅ Успешного голосования
- ✅ Запрета повторного голосования
- ✅ Корректного подсчёта голосов
- ✅ Получения результатов голосования
- ✅ Обработки ошибочных ситуаций

## Пользовательский интерфейс

### Функции интерфейса

1. **Подключение кошелька** — интеграция с MetaMask через RainbowKit
2. **Отображение вариантов** — список всех доступных вариантов голосования
3. **Голосование** — возможность проголосовать за выбранный вариант
4. **Результаты в реальном времени** — автоматическое обновление результатов
5. **Визуализация** — прогресс-бары для каждого варианта
6. **Статистика** — общее количество голосов и вариантов

### Состояния интерфейса

- **Не подключен кошелёк** — предложение подключить MetaMask
- **Уже проголосовал** — отображение результатов без возможности повторного голосования
- **Доступно голосование** — активные кнопки для голосования

## Дополнительные команды

```bash
# Компиляция контрактов
yarn hardhat:compile

# Запуск Hardhat node
yarn hardhat:node

# Проверка контракта
yarn hardhat:verify --network <network-name>

# Форматирование кода
yarn format

# Линтинг
yarn lint
```

## Безопасность

### Реализованные меры безопасности

- Проверка на повторное голосование через `mapping(address => bool)`
- Валидация индекса варианта голосования
- Валидация входных данных при создании контракта
- События для отслеживания всех действий
- Иммутабельность результатов после записи в блокчейн

## Критерии приёмки

Проект соответствует всем требованиям ТЗ:

- ✅ Смарт-контракт успешно компилируется и развёртывается
- ✅ Пользователь может проголосовать через веб-интерфейс
- ✅ Повторное голосование невозможно
- ✅ Результаты голосования отображаются корректно
- ✅ Проект запускается согласно инструкции
- ✅ Все данные хранятся в блокчейне
- ✅ Присутствуют модульные тесты
- ✅ Документация полная и актуальная

## Дополнительная информация

### Документация

- [Scaffold-ETH 2 Documentation](https://docs.scaffoldeth.io)
- [Hardhat Documentation](https://hardhat.org/docs)
- [Next.js Documentation](https://nextjs.org/docs)
- [Wagmi Documentation](https://wagmi.sh)

### Развёртывание в тестовых сетях

Для развёртывания в тестовых сетях (Sepolia, Goerli и т.д.):

1. Настройте `.env` файл с вашими ключами
2. Обновите конфигурацию сети в `hardhat.config.ts`
3. Запустите `yarn deploy --network <network-name>`

